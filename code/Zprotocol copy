import secrets
import string
import random
import hashlib
from timeit import repeat
import re
import requests



#Stuff for defining and tracking winning
winning = '000'
win = 0
count = 0


#Definition of x, y, and b
x = secrets.token_hex(16)
y = secrets.token_hex(16)


server_response = requests.get('https://api.drand.sh/public/latest').json()

#The loop
while win == 0:
    count = 0

    #Stuff for rand beacon
    round_no = server_response[ 'round' ]
    randomness = server_response[ 'randomness' ]

   #Defining, combining, and hashing strings x, y, and randomness
    b = secrets.token_hex(16)
    B = x + y + randomness
    combinedHash = str(hashlib.sha256(B.encode()).hexdigest())
    

    #Reducses Has to Last 3 characters
    Last_3combinedHash = combinedHash[-3:]
    
    while count < 11:
        print('Your new combined marker is ' + B + ' which is equal to ' + combinedHash + ' as a hash.')
        print('To win this round you need to match the last three hash characters which are, ' + Last_3combinedHash + ' to ' + winning + '".' )

        Last_3combinedHash = combinedHash[-3:]
        #Win function 
        if Last_3combinedHash == winning:
            win = win + 1
        count = count + 1        
        #Hashes the previousely hashed value
        combinedHash = str(hashlib.sha256(combinedHash.encode()).hexdigest())
    
    

print('Congrats you won!!!')
    


     
    










